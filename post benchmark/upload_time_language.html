<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .chart-section {
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 20px;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: #f5f5f5;
        }

        .btn.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }

        .chart-container {
            width: 100%;
            height: 500px;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Language Upload Time Heatmap -->
        <div class="chart-section">
            <div class="chart-controls">
                <button class="btn active" onclick="showView('hourly')">Hourly Patterns</button>
                <button class="btn" onclick="showView('daily')">Daily Trends</button>
                <button class="btn" onclick="showView('cultural')">Cultural Timing</button>
            </div>
            <div id="languageTimeHeatmap" class="chart-container"></div>
        </div>

        <!-- Secondary Charts Grid -->
        <div class="grid">
            <div class="chart-section">
                <div id="languageDistribution" class="chart-container"></div>
            </div>
            <div class="chart-section">
                <div id="engagementByLanguage" class="chart-container"></div>
            </div>
        </div>
    </div>

    <script>
        // Sample data for language upload time analysis
        const languageData = {
            languages: ['English', 'Spanish', 'French', 'German', 'Japanese', 'Korean', 'Chinese', 'Portuguese', 'Arabic', 'Hindi'],
            languageCodes: ['EN', 'ES', 'FR', 'DE', 'JA', 'KO', 'ZH', 'PT', 'AR', 'HI'],
            hours: ['00:00', '02:00', '04:00', '06:00', '08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00', '22:00'],
            days: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],
            culturalTimes: ['Morning Prayer', 'Work Hours', 'Lunch Break', 'Afternoon', 'Evening', 'Night', 'Late Night', 'Dawn'],
            
            generateHourlyData: function() {
                const data = [];
                this.languages.forEach((language, langIndex) => {
                    this.hours.forEach((hour, hourIndex) => {
                        let baseValue = 35;
                        
                        // Language-specific timing patterns based on cultural habits
                        if (language === 'English') {
                            if (hourIndex >= 8 && hourIndex <= 11) baseValue = 85; // 4-10 PM
                        } else if (language === 'Spanish') {
                            if (hourIndex >= 9 && hourIndex <= 11) baseValue = 90; // Later evening
                        } else if (language === 'Japanese') {
                            if (hourIndex >= 10 && hourIndex <= 11) baseValue = 95; // Very late evening
                        } else if (language === 'Korean') {
                            if (hourIndex >= 10 && hourIndex <= 11) baseValue = 92; // Late night culture
                        } else if (language === 'Chinese') {
                            if (hourIndex >= 9 && hourIndex <= 11) baseValue = 88; // Evening peak
                        } else if (language === 'Arabic') {
                            if (hourIndex >= 8 && hourIndex <= 10) baseValue = 85; // Evening after prayers
                        } else if (language === 'French') {
                            if (hourIndex >= 8 && hourIndex <= 10) baseValue = 80; // European evening
                        } else if (language === 'German') {
                            if (hourIndex >= 7 && hourIndex <= 9) baseValue = 82; // Earlier evening
                        } else if (language === 'Portuguese') {
                            if (hourIndex >= 9 && hourIndex <= 11) baseValue = 87; // Brazilian timing
                        } else if (language === 'Hindi') {
                            if (hourIndex >= 8 && hourIndex <= 10) baseValue = 89; // Indian evening
                        }
                        
                        const value = Math.round(baseValue + (Math.random() - 0.5) * 25);
                        data.push([hourIndex, langIndex, Math.max(0, value)]);
                    });
                });
                return data;
            },
            
            generateDailyData: function() {
                const data = [];
                this.languages.forEach((language, langIndex) => {
                    this.days.forEach((day, dayIndex) => {
                        let baseValue = 55;
                        
                        // Cultural day preferences
                        if (language === 'Arabic') {
                            if (dayIndex === 4) baseValue = 95; // Friday is important
                            if (dayIndex === 5) baseValue = 40; // Saturday lower
                        } else if (language === 'English' || language === 'German' || language === 'French') {
                            if (dayIndex >= 5) baseValue = 85; // Weekend activity
                        } else if (language === 'Japanese' || language === 'Korean') {
                            if (dayIndex >= 5) baseValue = 90; // Strong weekend culture
                        } else if (language === 'Spanish' || language === 'Portuguese') {
                            if (dayIndex >= 4) baseValue = 88; // Friday-Sunday peak
                        } else if (language === 'Chinese' || language === 'Hindi') {
                            if (dayIndex >= 5) baseValue = 82; // Moderate weekend increase
                        }
                        
                        const value = Math.round(baseValue + (Math.random() - 0.5) * 30);
                        data.push([dayIndex, langIndex, Math.max(0, value)]);
                    });
                });
                return data;
            },
            
            generateCulturalData: function() {
                const data = [];
                this.languages.forEach((language, langIndex) => {
                    this.culturalTimes.forEach((time, timeIndex) => {
                        let baseValue = 40;
                        
                        // Cultural timing preferences
                        if (language === 'Arabic') {
                            if (time === 'Morning Prayer') baseValue = 70;
                            if (time === 'Evening') baseValue = 90;
                        } else if (language === 'Japanese' || language === 'Korean') {
                            if (time === 'Late Night') baseValue = 95;
                            if (time === 'Work Hours') baseValue = 60;
                        } else if (language === 'English') {
                            if (time === 'Evening') baseValue = 85;
                            if (time === 'Afternoon') baseValue = 75;
                        } else if (language === 'Spanish' || language === 'Portuguese') {
                            if (time === 'Evening') baseValue = 88;
                            if (time === 'Lunch Break') baseValue = 70;
                        } else if (language === 'Chinese' || language === 'Hindi') {
                            if (time === 'Evening') baseValue = 87;
                            if (time === 'Work Hours') baseValue = 65;
                        } else if (language === 'French' || language === 'German') {
                            if (time === 'Evening') baseValue = 80;
                            if (time === 'Lunch Break') baseValue = 65;
                        }
                        
                        const value = Math.round(baseValue + (Math.random() - 0.5) * 25);
                        data.push([timeIndex, langIndex, Math.max(0, value)]);
                    });
                });
                return data;
            }
        };

        let currentChart;
        let currentView = 'hourly';

        function initializeCharts() {
            showView('hourly');
            initLanguageDistribution();
            initEngagementByLanguage();
        }

        function showView(view) {
            currentView = view;
            
            // Update button states
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`.btn[onclick="showView('${view}')"]`).classList.add('active');
            
            if (currentChart) {
                currentChart.dispose();
            }
            
            currentChart = echarts.init(document.getElementById('languageTimeHeatmap'));
            
            let data, xAxisData, yAxisData, maxValue;
            
            switch(view) {
                case 'hourly':
                    data = languageData.generateHourlyData();
                    xAxisData = languageData.hours;
                    yAxisData = languageData.languages;
                    maxValue = 100;
                    break;
                case 'daily':
                    data = languageData.generateDailyData();
                    xAxisData = languageData.days;
                    yAxisData = languageData.languages;
                    maxValue = 100;
                    break;
                case 'cultural':
                    data = languageData.generateCulturalData();
                    xAxisData = languageData.culturalTimes;
                    yAxisData = languageData.languages;
                    maxValue = 100;
                    break;
            }
            
            const option = {
                tooltip: {
                    position: 'top',
                    formatter: function (params) {
                        return `${xAxisData[params.data[0]]}<br/>${yAxisData[params.data[1]]}<br/>Posts: ${params.data[2]}`;
                    }
                },
                grid: {
                    height: '70%',
                    top: '10%',
                    left: '12%',
                    right: '10%'
                },
                xAxis: {
                    type: 'category',
                    data: xAxisData,
                    splitArea: {
                        show: true
                    },
                    axisLabel: {
                        rotate: view === 'cultural' ? 45 : 0
                    }
                },
                yAxis: {
                    type: 'category',
                    data: yAxisData,
                    splitArea: {
                        show: true
                    }
                },
                visualMap: {
                    min: 0,
                    max: maxValue,
                    calculable: true,
                    orient: 'horizontal',
                    left: 'center',
                    bottom: '5%',
                    inRange: {
                        color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027']
                    }
                },
                series: [{
                    type: 'heatmap',
                    data: data,
                    label: {
                        show: true,
                        formatter: function(params) {
                            return params.data[2]; // 仅显示作品数量
                        }
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }]
            };
            
            currentChart.setOption(option);
        }

        function initLanguageDistribution() {
            const chart = echarts.init(document.getElementById('languageDistribution'));
            
            const option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b}: {c} ({d}%)'
                },
                legend: {
                    orient: 'vertical',
                    left: 'left'
                },
                series: [
                    {
                        name: 'Language Distribution',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        avoidLabelOverlap: false,
                        label: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: '18',
                                fontWeight: 'bold'
                            }
                        },
                        labelLine: {
                            show: false
                        },
                        data: languageData.languages.map((lang, index) => ({
                            value: Math.round(100 + Math.random() * 400),
                            name: lang,
                            itemStyle: {
                                color: `hsl(${index * 36}, 70%, 60%)`
                            }
                        }))
                    }
                ]
            };
            
            chart.setOption(option);
        }

        function initEngagementByLanguage() {
            const chart = echarts.init(document.getElementById('engagementByLanguage'));
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['Likes', 'Comments', 'Shares']
                },
                xAxis: {
                    type: 'category',
                    data: languageData.languageCodes,
                    axisLabel: {
                        rotate: 0
                    }
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: 'Likes',
                        type: 'bar',
                        stack: 'engagement',
                        data: languageData.languages.map(() => Math.round(200 + Math.random() * 300)),
                        itemStyle: {
                            color: '#007bff'
                        }
                    },
                    {
                        name: 'Comments',
                        type: 'bar',
                        stack: 'engagement',
                        data: languageData.languages.map(() => Math.round(50 + Math.random() * 100)),
                        itemStyle: {
                            color: '#28a745'
                        }
                    },
                    {
                        name: 'Shares',
                        type: 'bar',
                        stack: 'engagement',
                        data: languageData.languages.map(() => Math.round(20 + Math.random() * 80)),
                        itemStyle: {
                            color: '#ffc107'
                        }
                    }
                ]
            };
            
            chart.setOption(option);
        }

        // Initialize charts when page loads
        window.addEventListener('load', initializeCharts);
        
        // Handle window resize
        window.addEventListener('resize', function() {
            if (currentChart) {
                currentChart.resize();
            }
            echarts.getInstanceByDom(document.getElementById('languageDistribution'))?.resize();
            echarts.getInstanceByDom(document.getElementById('engagementByLanguage'))?.resize();
        });
    </script>
</body>
</html>