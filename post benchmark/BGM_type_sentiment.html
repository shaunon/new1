<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGM Type Sentiment Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .data-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
            position: relative;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 1.5em;
            color: #2c3e50;
            font-weight: 600;
        }

        .download-icon {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .download-icon:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .chart-container {
            width: 100%;
            height: 400px;
            margin-bottom: 20px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .metric-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .data-table tr:hover {
            background: #f8f9fa;
        }

        .sentiment-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 500;
            color: white;
        }

        .sentiment-positive { background: #27ae60; }
        .sentiment-negative { background: #e74c3c; }
        .sentiment-neutral { background: #95a5a6; }

    </style>
</head>
<body>
    <div class="container">
        <!-- Key Metrics -->
        <div class="data-card">
            <div class="card-header">
                <h2 class="card-title">Sentiment Overview Metrics</h2>
                <button class="download-icon" onclick="downloadMetrics()">ðŸ“Š Download</button>
            </div>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">12.5K</div>
                    <div class="metric-label">Total Posts</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">3.2M</div>
                    <div class="metric-label">Total Likes</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">890K</div>
                    <div class="metric-label">Total Comments</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">1.5M</div>
                    <div class="metric-label">Total Shares</div>
                </div>
            </div>
        </div>

        <!-- Sentiment Distribution Chart -->
        <div class="data-card">
            <div class="card-header">
                <h2 class="card-title">BGM Type Sentiment Distribution</h2>
                <button class="download-icon" onclick="downloadChart('sentimentDistribution')">ðŸ“Š Download</button>
            </div>
            <div id="sentimentDistribution" class="chart-container"></div>
        </div>

        <!-- Sentiment by BGM Type Chart -->
        <div class="data-card">
            <div class="card-header">
                <h2 class="card-title">Sentiment Analysis by BGM Type</h2>
                <button class="download-icon" onclick="downloadChart('sentimentByType')">ðŸ“Š Download</button>
            </div>
            <div id="sentimentByType" class="chart-container"></div>
        </div>

        <!-- Sentiment Trends Chart -->
        <div class="data-card">
            <div class="card-header">
                <h2 class="card-title">Sentiment Trends Over Time</h2>
                <button class="download-icon" onclick="downloadChart('sentimentTrends')">ðŸ“Š Download</button>
            </div>
            <div id="sentimentTrends" class="chart-container"></div>
        </div>

        <!-- Detailed Sentiment Analysis Table -->
        <div class="data-card">
            <div class="card-header">
                <h2 class="card-title">Detailed Sentiment Analysis</h2>
                <button class="download-icon" onclick="downloadTable('sentimentTable')">ðŸ“Š Download</button>
            </div>
            <table class="data-table" id="sentimentTable">
                <thead>
                    <tr>
                        <th>BGM Type</th>
                        <th>Total Posts</th>
                        <th>Positive %</th>
                        <th>Neutral %</th>
                        <th>Negative %</th>
                        <th>Sentiment</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Pop Music</td>
                        <td>3,250</td>
                        <td>78.5%</td>
                        <td>15.2%</td>
                        <td>6.3%</td>
                        <td><span class="sentiment-badge sentiment-positive">Positive</span></td>
                    </tr>
                    <tr>
                        <td>Electronic</td>
                        <td>2,890</td>
                        <td>75.2%</td>
                        <td>18.1%</td>
                        <td>6.7%</td>
                        <td><span class="sentiment-badge sentiment-positive">Positive</span></td>
                    </tr>
                    <tr>
                        <td>Classical</td>
                        <td>2,650</td>
                        <td>82.3%</td>
                        <td>12.8%</td>
                        <td>4.9%</td>
                        <td><span class="sentiment-badge sentiment-positive">Positive</span></td>
                    </tr>
                    <tr>
                        <td>Jazz</td>
                        <td>1,820</td>
                        <td>68.4%</td>
                        <td>22.1%</td>
                        <td>9.5%</td>
                        <td><span class="sentiment-badge sentiment-positive">Positive</span></td>
                    </tr>
                    <tr>
                        <td>Rock</td>
                        <td>1,590</td>
                        <td>65.2%</td>
                        <td>20.3%</td>
                        <td>14.5%</td>
                        <td><span class="sentiment-badge sentiment-positive">Positive</span></td>
                    </tr>
                    <tr>
                        <td>Hip Hop</td>
                        <td>1,340</td>
                        <td>58.7%</td>
                        <td>25.8%</td>
                        <td>15.5%</td>
                        <td><span class="sentiment-badge sentiment-neutral">Neutral</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

    <script>
        // Sentiment Distribution Chart
        const sentimentDistributionChart = echarts.init(document.getElementById('sentimentDistribution'));
        const sentimentDistributionOption = {
                tooltip: {
                trigger: 'item',
                formatter: '{a} <br/>{b}: {c} ({d}%)'
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data: ['Positive', 'Neutral', 'Negative']
            },
            series: [
                {
                    name: 'Sentiment',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    label: {
                        show: true,
                        formatter: '{b}: {d}%'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '18',
                            fontWeight: 'bold'
                        }
                    },
                    data: [
                        { value: 72.3, name: 'Positive', itemStyle: { color: '#27ae60' } },
                        { value: 18.5, name: 'Neutral', itemStyle: { color: '#95a5a6' } },
                        { value: 9.2, name: 'Negative', itemStyle: { color: '#e74c3c' } }
                    ]
                }
            ]
        };
        sentimentDistributionChart.setOption(sentimentDistributionOption);

        // Sentiment by BGM Type Chart
        const sentimentByTypeChart = echarts.init(document.getElementById('sentimentByType'));
        const sentimentByTypeOption = {
                tooltip: {
                trigger: 'axis',
                axisPointer: { type: 'shadow' }
            },
            legend: {
                data: ['Positive', 'Neutral', 'Negative'],
                top: '10%'
            },
            xAxis: {
                type: 'category',
                data: ['Pop Music', 'Electronic', 'Classical', 'Jazz', 'Rock', 'Hip Hop']
            },
            yAxis: {
                type: 'value',
                name: 'Percentage (%)'
            },
            series: [
                {
                    name: 'Positive',
                    type: 'bar',
                    stack: 'total',
                    data: [78.5, 75.2, 82.3, 68.4, 65.2, 58.7],
                    itemStyle: { color: '#27ae60' }
                },
                {
                    name: 'Neutral',
                    type: 'bar',
                    stack: 'total',
                    data: [15.2, 18.1, 12.8, 22.1, 20.3, 25.8],
                    itemStyle: { color: '#95a5a6' }
                },
                {
                    name: 'Negative',
                    type: 'bar',
                    stack: 'total',
                    data: [6.3, 6.7, 4.9, 9.5, 14.5, 15.5],
                    itemStyle: { color: '#e74c3c' }
                }
            ]
        };
        sentimentByTypeChart.setOption(sentimentByTypeOption);

        // Sentiment Trends Chart
        const sentimentTrendsChart = echarts.init(document.getElementById('sentimentTrends'));
        const sentimentTrendsOption = {
                tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['Positive', 'Neutral', 'Negative'],
                top: '10%'
            },
            xAxis: {
                type: 'category',
                data: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']
            },
            yAxis: {
                type: 'value',
                name: 'Percentage (%)',
                max: 100
            },
            series: [
                {
                    name: 'Positive',
                    type: 'line',
                    data: [68.5, 70.2, 71.8, 72.1, 72.5, 72.3],
                    itemStyle: { color: '#27ae60' },
                    lineStyle: { width: 3 },
                    areaStyle: { opacity: 0.3 }
                },
                {
                    name: 'Neutral',
                    type: 'line',
                    data: [22.1, 20.8, 19.5, 19.2, 18.8, 18.5],
                    itemStyle: { color: '#95a5a6' },
                    lineStyle: { width: 3 },
                    areaStyle: { opacity: 0.3 }
                },
                {
                    name: 'Negative',
                    type: 'line',
                    data: [9.4, 9.0, 8.7, 8.7, 8.7, 9.2],
                    itemStyle: { color: '#e74c3c' },
                    lineStyle: { width: 3 },
                    areaStyle: { opacity: 0.3 }
                }
            ]
        };
        sentimentTrendsChart.setOption(sentimentTrendsOption);

        // Resize charts on window resize
        window.addEventListener('resize', function() {
            sentimentDistributionChart.resize();
            sentimentByTypeChart.resize();
            sentimentTrendsChart.resize();
        });

        // Download functions
        function downloadChart(chartId) {
            let chart;
            switch(chartId) {
                case 'sentimentDistribution':
                    chart = sentimentDistributionChart;
                    break;
                case 'sentimentByType':
                    chart = sentimentByTypeChart;
                    break;
                case 'sentimentTrends':
                    chart = sentimentTrendsChart;
                    break;
            }
            
            if (chart) {
                const url = chart.getDataURL({
                    pixelRatio: 2,
                    backgroundColor: '#fff'
                });
                const link = document.createElement('a');
                link.href = url;
                link.download = `${chartId}_chart.png`;
                link.click();
            }
        }

        function downloadTable(tableId) {
            const table = document.getElementById(tableId);
            let csv = [];
            const rows = table.querySelectorAll('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const row = [], cols = rows[i].querySelectorAll('td, th');
                for (let j = 0; j < cols.length; j++) {
                    let cellText = cols[j].innerText;
                    // Remove sentiment badges for CSV
                    if (cols[j].querySelector('.sentiment-badge')) {
                        cellText = cols[j].querySelector('.sentiment-badge').innerText;
                    }
                    row.push('"' + cellText + '"');
                }
                csv.push(row.join(','));
            }
            
            const csvFile = new Blob([csv.join('\n')], { type: 'text/csv' });
            const downloadLink = document.createElement('a');
            downloadLink.download = `${tableId}_data.csv`;
            downloadLink.href = window.URL.createObjectURL(csvFile);
            downloadLink.click();
        }

        function downloadMetrics() {
            const metrics = [
                ['Metric', 'Value'],
                ['Positive Sentiment', '72.3%'],
                ['Neutral Sentiment', '18.5%'],
                ['Negative Sentiment', '9.2%']
            ];
            
            const csv = metrics.map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
            const csvFile = new Blob([csv], { type: 'text/csv' });
            const downloadLink = document.createElement('a');
            downloadLink.download = 'sentiment_metrics.csv';
            downloadLink.href = window.URL.createObjectURL(csvFile);
            downloadLink.click();
        }
    </script>
</body>
</html>