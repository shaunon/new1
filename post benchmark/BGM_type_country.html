<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGM Type Analysis - Country Dimension</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script>
        // 内嵌世界地图数据 - 使用正确的GeoJSON格式
        echarts.registerMap('world', {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {"name": "United States"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[-130, 20], [-130, 50], [-60, 50], [-60, 20], [-130, 20]]
                        ]
                    }
                },
                {
                    "type": "Feature", 
                    "properties": {"name": "China"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[70, 15], [70, 55], [140, 55], [140, 15], [70, 15]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "Brazil"}, 
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[-75, -35], [-75, 10], [-30, 10], [-30, -35], [-75, -35]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "Germany"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[5, 47], [5, 55], [15, 55], [15, 47], [5, 47]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "India"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [[
                            [[68, 6], [68, 38], [98, 38], [98, 6], [68, 6]]
                        ]]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "United Kingdom"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[-8, 49], [-8, 61], [2, 61], [2, 49], [-8, 49]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "Japan"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[129, 30], [129, 46], [146, 46], [146, 30], [129, 30]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "France"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[-5, 42], [-5, 51], [8, 51], [8, 42], [-5, 42]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "Canada"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[-141, 41], [-141, 84], [-52, 84], [-52, 41], [-141, 41]]
                        ]
                    }
                },
                {
                    "type": "Feature",
                    "properties": {"name": "Australia"},
                    "geometry": {
                        "type": "Polygon", 
                        "coordinates": [
                            [[113, -44], [113, -10], [154, -10], [154, -44], [113, -44]]
                        ]
                    }
                }
            ]
        });
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            padding: 20px;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .summary-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
        }

        .summary-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
        }

        .summary-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            text-align: center;
            transition: transform 0.2s ease;
        }

        .summary-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .summary-label {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .summary-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .summary-change {
            font-size: 12px;
            font-weight: 600;
        }

        .positive { color: #28a745; }
        .negative { color: #dc3545; }

        .page-header {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .page-subtitle {
            font-size: 16px;
            color: #6c757d;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .chart-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            padding: 25px;
            position: relative;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        .download-btn {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            color: #495057;
            transition: all 0.2s ease;
        }

        .download-btn:hover {
            background: #e9ecef;
            color: #343a40;
        }

        .chart {
            width: 100%;
            height: 450px;
        }

        .map-chart {
            height: 550px;
        }

        .data-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            padding: 25px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }

        .data-table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .data-table th,
        .data-table td {
            padding: 12px 10px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        .data-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
            position: sticky;
            top: 0;
            z-index: 10;
            border: 1px solid #dee2e6;
            vertical-align: middle;
        }

        .bgm-header {
            background: #e3f2fd !important;
            color: #1976d2 !important;
            font-weight: 700;
            min-width: 120px;
        }

        .country-header {
            background: #e8f5e8 !important;
            color: #2e7d32 !important;
            font-weight: 700;
            min-width: 100px;
        }

        .metric-header {
            background: #f3e5f5 !important;
            color: #7b1fa2 !important;
            font-weight: 700;
            min-width: 100px;
        }

        .metric-group-header {
            background: #e8f5e8 !important;
            color: #2e7d32 !important;
            font-weight: 700;
            text-align: center;
        }

        .mom-header {
            background: #fff3e0 !important;
            color: #f57c00 !important;
            font-weight: 600;
            min-width: 90px;
        }

        .ratio-header {
            background: #fce4ec !important;
            color: #c2185b !important;
            font-weight: 600;
            min-width: 100px;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .mom-value {
            font-weight: 600;
        }

        .mom-value.positive {
            color: #28a745;
        }

        .mom-value.negative {
            color: #dc3545;
        }

        @media (max-width: 768px) {
            .chart {
                height: 350px;
            }
            
            .map-chart {
                height: 450px;
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Data Summary Section -->
        <div class="summary-section">
            <div class="summary-title">BGM Type Analysis - Country Dimension Summary</div>
            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-label">Total Countries</div>
                    <div class="summary-value">10</div>
                    <div class="summary-change positive">+2 MoM</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Total Post Count</div>
                    <div class="summary-value">125.8M</div>
                    <div class="summary-change positive">+12.3% MoM</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Top Country</div>
                    <div class="summary-value">United States</div>
                    <div class="summary-change positive">+15.2% MoM</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Highest Interaction Rate</div>
                    <div class="summary-value">Japan</div>
                    <div class="summary-change positive">+8.7% MoM</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Fastest Growing</div>
                    <div class="summary-value">India</div>
                    <div class="summary-change positive">+28.4% MoM</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Average Interaction Rate</div>
                    <div class="summary-value">14.9%</div>
                    <div class="summary-change positive">+2.1% MoM</div>
                </div>
            </div>
        </div>


        <!-- Charts Grid -->
        <div class="charts-grid">
            <!-- Map Bubble Chart with MoM Tooltips -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">Global BGM Performance Map with Post Count MoM</div>
                    <button class="download-btn" onclick="downloadChart('mapChart')" title="Download Chart">
                        📥 Download
                    </button>
                </div>
                <div id="mapChart" class="chart map-chart"></div>
            </div>

            <!-- Horizontal Bar Chart with MoM Arrows -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">Top Countries by Post Count and Interaction Count with MoM Arrows</div>
                    <button class="download-btn" onclick="downloadChart('barChart')" title="Download Chart">
                        📥 Download
                    </button>
                </div>
                <div id="barChart" class="chart"></div>
            </div>

            <!-- Three-Axis Trend Lines with MoM Comparisons -->
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">Country Performance Trends with MoM Comparisons</div>
                    <button class="download-btn" onclick="downloadChart('trendChart')" title="Download Chart">
                        📥 Download
                    </button>
                </div>
                <div id="trendChart" class="chart"></div>
            </div>
        </div>

        <!-- Data Table Section -->
        <div class="data-section">
            <div class="section-header">
                <div class="section-title">Country Analysis Data</div>
                <button class="download-btn" onclick="downloadTableData()" title="Download Table Data">
                    📥 Download CSV
                </button>
            </div>
            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th rowspan="2" class="bgm-header">BGM Type</th>
                            <th rowspan="2" class="country-header">Country</th>
                            <th colspan="2" class="metric-group-header">Post</th>
                            <th colspan="2" class="metric-group-header">Interaction</th>
                            <th colspan="2" class="metric-group-header">Rate</th>
                            <th colspan="2" class="metric-group-header">Global Ratio</th>
                        </tr>
                        <tr>
                            <th class="metric-header">Count</th>
                            <th class="mom-header">MoM (%)</th>
                            <th class="metric-header">Count</th>
                            <th class="mom-header">MoM (%)</th>
                            <th class="metric-header">Rate</th>
                            <th class="mom-header">MoM (%)</th>
                            <th class="ratio-header">Ratio</th>
                            <th class="mom-header">MoM (pp)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Pop Music</strong></td>
                            <td><strong>United States</strong></td>
                            <td>15,234,567</td>
                            <td><span class="mom-value positive">+12.5%</span></td>
                            <td>1,523,456</td>
                            <td><span class="mom-value positive">+15.3%</span></td>
                            <td>10.0%</td>
                            <td><span class="mom-value positive">+2.5%</span></td>
                            <td>25.3%</td>
                            <td><span class="mom-value positive">+1.2pp</span></td>
                        </tr>
                        <tr>
                            <td><strong>Pop Music</strong></td>
                            <td><strong>China</strong></td>
                            <td>12,876,543</td>
                            <td><span class="mom-value positive">+18.7%</span></td>
                            <td>1,287,654</td>
                            <td><span class="mom-value positive">+22.1%</span></td>
                            <td>10.0%</td>
                            <td><span class="mom-value positive">+2.9%</span></td>
                            <td>21.4%</td>
                            <td><span class="mom-value positive">+1.8pp</span></td>
                        </tr>
                        <tr>
                            <td><strong>Hip Hop</strong></td>
                            <td><strong>United States</strong></td>
                            <td>18,567,890</td>
                            <td><span class="mom-value positive">+24.6%</span></td>
                            <td>2,228,547</td>
                            <td><span class="mom-value positive">+28.9%</span></td>
                            <td>12.0%</td>
                            <td><span class="mom-value positive">+3.4%</span></td>
                            <td>31.5%</td>
                            <td><span class="mom-value positive">+2.1pp</span></td>
                        </tr>
                        <tr>
                            <td><strong>Hip Hop</strong></td>
                            <td><strong>Brazil</strong></td>
                            <td>9,876,543</td>
                            <td><span class="mom-value positive">+19.3%</span></td>
                            <td>1,185,185</td>
                            <td><span class="mom-value positive">+23.7%</span></td>
                            <td>12.0%</td>
                            <td><span class="mom-value positive">+3.7%</span></td>
                            <td>16.8%</td>
                            <td><span class="mom-value positive">+1.5pp</span></td>
                        </tr>
                        <tr>
                            <td><strong>Electronic</strong></td>
                            <td><strong>Germany</strong></td>
                            <td>7,654,321</td>
                            <td><span class="mom-value positive">+14.2%</span></td>
                            <td>918,518</td>
                            <td><span class="mom-value positive">+17.8%</span></td>
                            <td>12.0%</td>
                            <td><span class="mom-value positive">+3.1%</span></td>
                            <td>13.0%</td>
                            <td><span class="mom-value positive">+0.9pp</span></td>
                        </tr>
                        <tr>
                            <td><strong>Electronic</strong></td>
                            <td><strong>Netherlands</strong></td>
                            <td>5,432,109</td>
                            <td><span class="mom-value positive">+11.8%</span></td>
                            <td>651,853</td>
                            <td><span class="mom-value positive">+15.4%</span></td>
                            <td>12.0%</td>
                            <td><span class="mom-value positive">+3.2%</span></td>
                            <td>9.2%</td>
                            <td><span class="mom-value positive">+0.7pp</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Sample data for country analysis
        const countryData = {
            mapData: [
                { name: 'United States', value: ['-95.7129', '37.0902', 15234567], mom: 12.5 },
                { name: 'China', value: ['104.1954', '35.8617', 12876543], mom: 18.7 },
                { name: 'Brazil', value: ['-51.9253', '-14.2350', 9876543], mom: 19.3 },
                { name: 'Germany', value: ['10.4515', '51.1657', 7654321], mom: 14.2 },
                { name: 'India', value: ['78.9629', '20.5937', 6543210], mom: 16.8 },
                { name: 'United Kingdom', value: ['-3.4360', '55.3781', 5432109], mom: 13.5 },
                { name: 'Japan', value: ['138.2529', '36.2048', 4321098], mom: 9.7 },
                { name: 'France', value: ['2.2137', '46.2276', 3210987], mom: 11.2 },
                { name: 'Canada', value: ['-106.3468', '56.1304', 2109876], mom: 8.9 },
                { name: 'Australia', value: ['133.7751', '-25.2744', 1098765], mom: 7.3 }
            ],
            barData: {
                countries: ['United States', 'China', 'Brazil', 'Germany', 'India', 'United Kingdom'],
                postCount: [15234567, 12876543, 9876543, 7654321, 6543210, 5432109],
                interactionCount: [1523456, 1287654, 1185185, 918518, 784785, 651853],
                postMoM: [12.5, 18.7, 19.3, 14.2, 16.8, 13.5],
                interactionMoM: [15.3, 22.1, 23.7, 17.8, 20.4, 16.9]
            },
            trendData: {
                months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                postCount: [12000000, 13500000, 14200000, 14800000, 15100000, 15234567],
                interactionCount: [1200000, 1350000, 1420000, 1480000, 1510000, 1523456],
                interactionRate: [10.0, 10.0, 10.0, 10.0, 10.0, 10.0],
                postMoM: [8.5, 12.5, 5.2, 4.2, 2.0, 0.9],
                interactionMoM: [10.2, 12.5, 5.2, 4.2, 2.0, 0.9],
                rateMoM: [1.5, 0.0, 0.0, 0.0, 0.0, 0.0]
            }
        };

        // Initialize charts
        const mapChart = echarts.init(document.getElementById('mapChart'));
        const barChart = echarts.init(document.getElementById('barChart'));
        const trendChart = echarts.init(document.getElementById('trendChart'));

        // Map Bubble Chart with MoM Tooltips
        const mapOption = {
            tooltip: {
                trigger: 'item',
                formatter: function(params) {
                    if (params.seriesType === 'scatter') {
                        const data = params.data;
                        return `${data.name}<br/>
                                Post Count: ${(data.value[2] / 1000000).toFixed(1)}M<br/>
                                <span style="color: ${data.mom > 0 ? '#28a745' : '#dc3545'}">Post Count MoM: ${data.mom > 0 ? '+' : ''}${data.mom}%</span>`;
                    }
                    return params.name;
                }
            },
            geo: {
                map: 'world',
                roam: true,
                itemStyle: {
                    areaColor: '#f0f0f0',
                    borderColor: '#999'
                },
                emphasis: {
                    itemStyle: {
                        areaColor: '#e0e0e0'
                    }
                }
            },
            series: [
                {
                    type: 'scatter',
                    coordinateSystem: 'geo',
                    data: countryData.mapData,
                    symbolSize: function(val) {
                        return Math.max(10, Math.min(50, val[2] / 500000));
                    },
                    itemStyle: {
                        color: function(params) {
                            const mom = params.data.mom;
                            if (mom > 15) return '#28a745';
                            if (mom > 10) return '#ffc107';
                            return '#17a2b8';
                        },
                        shadowBlur: 10,
                        shadowColor: 'rgba(0, 0, 0, 0.3)'
                    },
                    emphasis: {
                        itemStyle: {
                            borderColor: '#fff',
                            borderWidth: 2
                        }
                    }
                }
            ]
        };

        // Horizontal Bar Chart with MoM Arrows
        const barOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: { type: 'shadow' }
            },
            legend: {
                data: ['Post Count', 'Interaction Count']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                name: 'Count (Millions)'
            },
            yAxis: {
                type: 'category',
                data: countryData.barData.countries
            },
            series: [
                {
                    name: 'Post Count',
                    type: 'bar',
                    data: countryData.barData.postCount.map((value, index) => ({
                        value: value,
                        mom: countryData.barData.postMoM[index]
                    })),
                    itemStyle: { color: '#1976d2' },
                    label: {
                        show: true,
                        position: 'right',
                        formatter: function(params) {
                            const mom = params.data.mom;
                            const arrow = mom > 0 ? '↗' : '↘';
                            return `${arrow} ${mom > 0 ? '+' : ''}${mom}%`;
                        },
                        color: function(params) {
                            return params.data.mom > 0 ? '#28a745' : '#dc3545';
                        },
                        fontSize: 11,
                        fontWeight: 'bold'
                    }
                },
                {
                    name: 'Interaction Count',
                    type: 'bar',
                    data: countryData.barData.interactionCount.map((value, index) => ({
                        value: value,
                        mom: countryData.barData.interactionMoM[index]
                    })),
                    itemStyle: { color: '#2e7d32' }
                }
            ]
        };

        // Three-Axis Trend Lines with MoM Comparisons
        const trendOption = {
            tooltip: {
                trigger: 'axis',
                axisPointer: { type: 'cross' }
            },
            legend: {
                data: ['Post Count', 'Interaction Count', 'Interaction Rate', 'Post MoM', 'Interaction MoM', 'Rate MoM'],
                selected: {
                    'Post MoM': false,
                    'Interaction MoM': false,
                    'Rate MoM': false
                }
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                data: countryData.trendData.months
            },
            yAxis: [
                {
                    type: 'value',
                    name: 'Count (Millions)',
                    position: 'left',
                    axisLabel: { formatter: function(value) { return (value / 1000000).toFixed(0) + 'M'; } }
                },
                {
                    type: 'value',
                    name: 'Rate (%)',
                    position: 'right',
                    axisLabel: { formatter: '{value}%' }
                },
                {
                    type: 'value',
                    name: 'MoM (%)',
                    position: 'right',
                    offset: 80,
                    axisLabel: { formatter: '{value}%' }
                }
            ],
            series: [
                {
                    name: 'Post Count',
                    type: 'line',
                    yAxisIndex: 0,
                    data: countryData.trendData.postCount,
                    itemStyle: { color: '#1976d2' },
                    lineStyle: { width: 3 }
                },
                {
                    name: 'Interaction Count',
                    type: 'line',
                    yAxisIndex: 0,
                    data: countryData.trendData.interactionCount,
                    itemStyle: { color: '#2e7d32' },
                    lineStyle: { width: 3 }
                },
                {
                    name: 'Interaction Rate',
                    type: 'line',
                    yAxisIndex: 1,
                    data: countryData.trendData.interactionRate,
                    itemStyle: { color: '#7b1fa2' },
                    lineStyle: { width: 3 }
                },
                {
                    name: 'Post MoM',
                    type: 'line',
                    yAxisIndex: 2,
                    data: countryData.trendData.postMoM,
                    itemStyle: { color: '#f57c00' },
                    lineStyle: { width: 2, type: 'dashed' }
                },
                {
                    name: 'Interaction MoM',
                    type: 'line',
                    yAxisIndex: 2,
                    data: countryData.trendData.interactionMoM,
                    itemStyle: { color: '#ff5722' },
                    lineStyle: { width: 2, type: 'dashed' }
                },
                {
                    name: 'Rate MoM',
                    type: 'line',
                    yAxisIndex: 2,
                    data: countryData.trendData.rateMoM,
                    itemStyle: { color: '#9c27b0' },
                    lineStyle: { width: 2, type: 'dashed' }
                }
            ]
        };

        // Set chart options
        mapChart.setOption(mapOption);
        barChart.setOption(barOption);
        trendChart.setOption(trendOption);

        // Download chart function
        function downloadChart(chartId) {
            const chart = echarts.getInstanceByDom(document.getElementById(chartId));
            const url = chart.getDataURL({
                pixelRatio: 2,
                backgroundColor: '#fff'
            });
            const link = document.createElement('a');
            link.href = url;
            link.download = chartId + '.png';
            link.click();
        }

        // Download table data function
        function downloadTableData() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "BGM Type,Country,Post Count,Post MoM (%),Interaction Count,Interaction MoM (%),Interaction Rate,Rate MoM (%),Global Post Ratio,Ratio MoM (pp)\n"
                + "Pop Music,United States,15234567,+12.5%,1523456,+15.3%,10.0%,+2.5%,25.3%,+1.2pp\n"
                + "Pop Music,China,12876543,+18.7%,1287654,+22.1%,10.0%,+2.9%,21.4%,+1.8pp\n"
                + "Hip Hop,United States,18567890,+24.6%,2228547,+28.9%,12.0%,+3.4%,31.5%,+2.1pp\n"
                + "Hip Hop,Brazil,9876543,+19.3%,1185185,+23.7%,12.0%,+3.7%,16.8%,+1.5pp\n"
                + "Electronic,Germany,7654321,+14.2%,918518,+17.8%,12.0%,+3.1%,13.0%,+0.9pp\n"
                + "Electronic,Netherlands,5432109,+11.8%,651853,+15.4%,12.0%,+3.2%,9.2%,+0.7pp";
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "bgm_country_analysis.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Responsive resize
        window.addEventListener('resize', function() {
            mapChart.resize();
            barChart.resize();
            trendChart.resize();
        });
    </script>
</body>
</html>