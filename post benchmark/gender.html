<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .chart-section {
            margin-bottom: 40px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
        }
        
        .chart-controls {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .toggle-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .toggle-btn:hover {
            background: #0056b3;
        }
        
        .toggle-btn.active {
            background: #28a745;
        }
        
        .chart-container {
            width: 100%;
            height: 400px;
            margin-bottom: 20px;
        }
        
        .bar-charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .bar-chart {
            height: 300px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .data-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .download-section {
            margin-top: 20px;
            text-align: center;
        }
        
        .download-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .download-btn:hover {
            background: #545b62;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Time Series Chart Section -->
        <div class="chart-section">
            <div class="chart-controls">
                <button class="toggle-btn active" onclick="updateTimeChart('river')">River Chart</button>
                <button class="toggle-btn" onclick="updateTimeChart('area')">Area Chart</button>
                <button class="download-btn" onclick="downloadChart('timeChart', 'gender_time_chart')" title="Download Chart">⬇</button>
            </div>
            <div id="timeChart" class="chart-container"></div>
        </div>

        <!-- Bar Charts Section -->
        <div class="chart-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <span style="font-weight: 600;">Distribution by Gender</span>
                <div>
                    <button class="download-btn" onclick="downloadChart('countryChart', 'gender_country_chart')" title="Download Country Chart">⬇ Country</button>
                    <button class="download-btn" onclick="downloadChart('platformChart', 'gender_platform_chart')" title="Download Platform Chart">⬇ Platform</button>
                    <button class="download-btn" onclick="downloadChart('sentimentChart', 'gender_sentiment_chart')" title="Download Sentiment Chart">⬇ Sentiment</button>
                    <button class="download-btn" onclick="downloadChart('languageChart', 'gender_language_chart')" title="Download Language Chart">⬇ Language</button>
                </div>
            </div>
            <div class="bar-charts-grid">
                <div id="countryChart" class="bar-chart"></div>
                <div id="platformChart" class="bar-chart"></div>
                <div id="sentimentChart" class="bar-chart"></div>
                <div id="languageChart" class="bar-chart"></div>
            </div>
        </div>

        <!-- Word Cloud / Sunburst Chart Section -->
        <div class="chart-section">
            <div class="chart-controls">
                <button class="toggle-btn active" onclick="updateTopChart('wordcloud')">Word Cloud</button>
                <button class="toggle-btn" onclick="updateTopChart('sunburst')">Sunburst Chart</button>
                <button class="download-btn" onclick="downloadChart('topChart', 'gender_top_chart')" title="Download Chart">⬇</button>
            </div>
            <div id="topChart" class="chart-container"></div>
        </div>

        <!-- Data Table Section -->
        <div class="chart-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <span style="font-weight: 600;">Gender Analysis Summary</span>
                <button class="download-btn" onclick="downloadTableData()" title="Download Table Data">⬇ Table</button>
            </div>
            <table class="data-table" id="dataTable">
                <thead>
                    <tr>
                        <th>Gender</th>
                        <th>Author Count</th>
                        <th>Post Count</th>
                        <th>Engagement</th>
                        <th>Net Sentiment</th>
                        <th>Potential Reach</th>
                    </tr>
                </thead>
                <tbody id="dataTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Sample gender data
        const genderData = {
            timeData: {
                dates: ['2024-01', '2024-02', '2024-03', '2024-04', '2024-05', '2024-06'],
                male: [1200, 1350, 1100, 1400, 1250, 1500],
                female: [1800, 1650, 1900, 1750, 2000, 1850]
            },
            countryData: {
                male: [
                    {name: 'USA', value: 35},
                    {name: 'UK', value: 25},
                    {name: 'Canada', value: 20},
                    {name: 'Australia', value: 15},
                    {name: 'Others', value: 5}
                ],
                female: [
                    {name: 'USA', value: 40},
                    {name: 'UK', value: 22},
                    {name: 'Canada', value: 18},
                    {name: 'Australia', value: 12},
                    {name: 'Others', value: 8}
                ]
            },
            platformData: {
                male: [
                    {name: 'Instagram', value: 30},
                    {name: 'TikTok', value: 25},
                    {name: 'YouTube', value: 20},
                    {name: 'Twitter', value: 15},
                    {name: 'Facebook', value: 10}
                ],
                female: [
                    {name: 'Instagram', value: 35},
                    {name: 'TikTok', value: 30},
                    {name: 'YouTube', value: 18},
                    {name: 'Twitter', value: 12},
                    {name: 'Facebook', value: 5}
                ]
            },
            sentimentData: {
                male: [
                    {name: 'Positive', value: 45},
                    {name: 'Neutral', value: 35},
                    {name: 'Negative', value: 20}
                ],
                female: [
                    {name: 'Positive', value: 50},
                    {name: 'Neutral', value: 30},
                    {name: 'Negative', value: 20}
                ]
            },
            languageData: {
                male: [
                    {name: 'English', value: 60},
                    {name: 'Spanish', value: 15},
                    {name: 'French', value: 10},
                    {name: 'German', value: 8},
                    {name: 'Others', value: 7}
                ],
                female: [
                    {name: 'English', value: 65},
                    {name: 'Spanish', value: 12},
                    {name: 'French', value: 8},
                    {name: 'German', value: 7},
                    {name: 'Others', value: 8}
                ]
            },
            topData: {
                male: [
                    {name: 'fitness', value: 120}, {name: 'sports', value: 110}, {name: 'gaming', value: 100},
                    {name: 'tech', value: 95}, {name: 'cars', value: 90}, {name: 'music', value: 85},
                    {name: 'travel', value: 80}, {name: 'food', value: 75}, {name: 'fashion', value: 70},
                    {name: 'business', value: 65}, {name: 'health', value: 60}, {name: 'education', value: 55},
                    {name: 'art', value: 50}, {name: 'photography', value: 48}, {name: 'movies', value: 45},
                    {name: 'books', value: 42}, {name: 'nature', value: 40}, {name: 'science', value: 38},
                    {name: 'politics', value: 35}, {name: 'history', value: 32}, {name: 'cooking', value: 30},
                    {name: 'design', value: 28}, {name: 'architecture', value: 25}, {name: 'finance', value: 22},
                    {name: 'startup', value: 20}, {name: 'innovation', value: 18}, {name: 'leadership', value: 15},
                    {name: 'motivation', value: 12}, {name: 'success', value: 10}, {name: 'goals', value: 8},
                    {name: 'mindset', value: 7}, {name: 'productivity', value: 6}, {name: 'strategy', value: 5},
                    {name: 'growth', value: 4}, {name: 'networking', value: 3}, {name: 'mentorship', value: 2},
                    {name: 'career', value: 1}, {name: 'skills', value: 1}, {name: 'learning', value: 1},
                    {name: 'development', value: 1}, {name: 'training', value: 1}, {name: 'workshop', value: 1},
                    {name: 'conference', value: 1}, {name: 'seminar', value: 1}, {name: 'webinar', value: 1},
                    {name: 'podcast', value: 1}, {name: 'blog', value: 1}, {name: 'content', value: 1},
                    {name: 'marketing', value: 1}, {name: 'branding', value: 1}
                ],
                female: [
                    {name: 'beauty', value: 150}, {name: 'fashion', value: 140}, {name: 'lifestyle', value: 130},
                    {name: 'wellness', value: 120}, {name: 'skincare', value: 110}, {name: 'makeup', value: 100},
                    {name: 'health', value: 95}, {name: 'fitness', value: 90}, {name: 'food', value: 85},
                    {name: 'travel', value: 80}, {name: 'family', value: 75}, {name: 'parenting', value: 70},
                    {name: 'home', value: 65}, {name: 'decor', value: 60}, {name: 'diy', value: 55},
                    {name: 'crafts', value: 50}, {name: 'photography', value: 48}, {name: 'art', value: 45},
                    {name: 'music', value: 42}, {name: 'books', value: 40}, {name: 'education', value: 38},
                    {name: 'career', value: 35}, {name: 'business', value: 32}, {name: 'inspiration', value: 30},
                    {name: 'motivation', value: 28}, {name: 'selfcare', value: 25}, {name: 'mindfulness', value: 22},
                    {name: 'yoga', value: 20}, {name: 'meditation', value: 18}, {name: 'spirituality', value: 15},
                    {name: 'relationships', value: 12}, {name: 'love', value: 10}, {name: 'friendship', value: 8},
                    {name: 'community', value: 7}, {name: 'support', value: 6}, {name: 'empowerment', value: 5},
                    {name: 'confidence', value: 4}, {name: 'strength', value: 3}, {name: 'courage', value: 2},
                    {name: 'resilience', value: 1}, {name: 'growth', value: 1}, {name: 'healing', value: 1},
                    {name: 'transformation', value: 1}, {name: 'journey', value: 1}, {name: 'adventure', value: 1},
                    {name: 'exploration', value: 1}, {name: 'discovery', value: 1}, {name: 'creativity', value: 1},
                    {name: 'expression', value: 1}, {name: 'passion', value: 1}, {name: 'purpose', value: 1},
                    {name: 'dreams', value: 1}, {name: 'vision', value: 1}
                ]
            },
            statsData: {
                male: {
                    authorCount: 15420,
                    postCount: 45680,
                    engagement: 2.8,
                    netSentiment: 0.65,
                    potentialReach: 1250000
                },
                female: {
                    authorCount: 18750,
                    postCount: 52340,
                    engagement: 3.2,
                    netSentiment: 0.72,
                    potentialReach: 1580000
                }
            }
        };

        // Initialize charts
        let timeChart, countryChart, platformChart, sentimentChart, languageChart, topChart;
        let currentTimeChartType = 'river';
        let currentTopChartType = 'wordcloud';

        // Initialize all charts when page loads
        window.onload = function() {
            initTimeChart();
            initBarCharts();
            initTopChart();
            initDataTable();
        };

        function initTimeChart() {
            timeChart = echarts.init(document.getElementById('timeChart'));
            updateTimeChart('river');
        }

        function updateTimeChart(type) {
            timeChart.clear();
            currentTimeChartType = type;
            
            // Update button states
            const timeSection = document.querySelector('.chart-section:first-child');
            timeSection.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
                if ((type === 'river' && btn.textContent === 'River Chart') || 
                    (type === 'area' && btn.textContent === 'Area Chart')) {
                    btn.classList.add('active');
                }
            });

            let option;
            
            if (type === 'river') {
                option = {
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'line'
                        }
                    },
                    legend: {
                        data: ['Male', 'Female']
                    },
                    singleAxis: {
                        top: 50,
                        bottom: 50,
                        axisTick: {},
                        axisLabel: {},
                        type: 'time',
                        axisPointer: {
                            animation: true,
                            label: {
                                show: true
                            }
                        },
                        splitLine: {
                            show: true,
                            lineStyle: {
                                type: 'dashed',
                                opacity: 0.2
                            }
                        }
                    },
                    series: [
                        {
                            type: 'themeRiver',
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 20,
                                    shadowColor: 'rgba(0, 0, 0, 0.8)'
                                }
                            },
                            data: [
                                ...genderData.timeData.dates.map((date, index) => [
                                    date, genderData.timeData.male[index], 'Male'
                                ]),
                                ...genderData.timeData.dates.map((date, index) => [
                                    date, genderData.timeData.female[index], 'Female'
                                ])
                            ]
                        }
                    ]
                };
            } else {
                option = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['Male', 'Female']
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: genderData.timeData.dates
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series: [
                        {
                            name: 'Male',
                            type: 'line',
                            stack: 'Total',
                            areaStyle: {},
                            emphasis: {
                                focus: 'series'
                            },
                            data: genderData.timeData.male
                        },
                        {
                            name: 'Female',
                            type: 'line',
                            stack: 'Total',
                            areaStyle: {},
                            emphasis: {
                                focus: 'series'
                            },
                            data: genderData.timeData.female
                        }
                    ]
                };
            }
            
            timeChart.setOption(option);
        }

        function initBarCharts() {
            // Country Chart
            countryChart = echarts.init(document.getElementById('countryChart'));
            const countryOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['Male', 'Female']
                },
                xAxis: {
                    type: 'category',
                    data: genderData.countryData.male.map(item => item.name)
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: 'Male',
                        type: 'bar',
                        data: genderData.countryData.male.map(item => item.value)
                    },
                    {
                        name: 'Female',
                        type: 'bar',
                        data: genderData.countryData.female.map(item => item.value)
                    }
                ]
            };
            countryChart.setOption(countryOption);

            // Platform Chart
            platformChart = echarts.init(document.getElementById('platformChart'));
            const platformOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['Male', 'Female']
                },
                xAxis: {
                    type: 'category',
                    data: genderData.platformData.male.map(item => item.name)
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: 'Male',
                        type: 'bar',
                        data: genderData.platformData.male.map(item => item.value)
                    },
                    {
                        name: 'Female',
                        type: 'bar',
                        data: genderData.platformData.female.map(item => item.value)
                    }
                ]
            };
            platformChart.setOption(platformOption);

            // Sentiment Chart
            sentimentChart = echarts.init(document.getElementById('sentimentChart'));
            const sentimentOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['Male', 'Female']
                },
                xAxis: {
                    type: 'category',
                    data: genderData.sentimentData.male.map(item => item.name)
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: 'Male',
                        type: 'bar',
                        data: genderData.sentimentData.male.map(item => item.value)
                    },
                    {
                        name: 'Female',
                        type: 'bar',
                        data: genderData.sentimentData.female.map(item => item.value)
                    }
                ]
            };
            sentimentChart.setOption(sentimentOption);

            // Language Chart
            languageChart = echarts.init(document.getElementById('languageChart'));
            const languageOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                legend: {
                    data: ['Male', 'Female']
                },
                xAxis: {
                    type: 'category',
                    data: genderData.languageData.male.map(item => item.name)
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: 'Male',
                        type: 'bar',
                        data: genderData.languageData.male.map(item => item.value)
                    },
                    {
                        name: 'Female',
                        type: 'bar',
                        data: genderData.languageData.female.map(item => item.value)
                    }
                ]
            };
            languageChart.setOption(languageOption);
        }

        function initTopChart() {
            topChart = echarts.init(document.getElementById('topChart'));
            updateTopChart('wordcloud');
        }

        function updateTopChart(type) {
            topChart.clear();
            currentTopChartType = type;
            
            // Update button states
            const topSection = document.querySelector('.chart-section:nth-child(3)');
            topSection.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
                if ((type === 'wordcloud' && btn.textContent === 'Word Cloud') || 
                    (type === 'sunburst' && btn.textContent === 'Sunburst Chart')) {
                    btn.classList.add('active');
                }
            });

            let option;
            
            if (type === 'wordcloud') {
                // Combine male and female data for word cloud
                const combinedData = [];
                genderData.topData.male.forEach(item => {
                    combinedData.push({name: item.name + ' (M)', value: item.value});
                });
                genderData.topData.female.forEach(item => {
                    combinedData.push({name: item.name + ' (F)', value: item.value});
                });
                
                option = {
                    tooltip: {},
                    series: [{
                        type: 'wordCloud',
                        gridSize: 2,
                        sizeRange: [12, 50],
                        rotationRange: [-90, 90],
                        shape: 'pentagon',
                        width: '100%',
                        height: '100%',
                        drawOutOfBound: true,
                        textStyle: {
                            fontFamily: 'sans-serif',
                            fontWeight: 'bold',
                            color: function () {
                                return 'rgb(' + [
                                    Math.round(Math.random() * 160),
                                    Math.round(Math.random() * 160),
                                    Math.round(Math.random() * 160)
                                ].join(',') + ')';
                            }
                        },
                        emphasis: {
                            textStyle: {
                                shadowBlur: 10,
                                shadowColor: '#333'
                            }
                        },
                        data: combinedData
                    }]
                };
            } else {
                // Sunburst chart
                const sunburstData = [
                    {
                        name: 'Male',
                        children: genderData.topData.male.slice(0, 20).map(item => ({
                            name: item.name,
                            value: item.value
                        }))
                    },
                    {
                        name: 'Female',
                        children: genderData.topData.female.slice(0, 20).map(item => ({
                            name: item.name,
                            value: item.value
                        }))
                    }
                ];
                
                option = {
                    tooltip: {
                        trigger: 'item'
                    },
                    series: {
                        type: 'sunburst',
                        data: sunburstData,
                        radius: [0, '90%'],
                        itemStyle: {
                            borderRadius: 7,
                            borderWidth: 2
                        },
                        label: {
                            show: false
                        }
                    }
                };
            }
            
            topChart.setOption(option);
        }

        function initDataTable() {
            const tableBody = document.getElementById('dataTableBody');
            const data = [
                {
                    gender: 'Male',
                    authorCount: genderData.statsData.male.authorCount.toLocaleString(),
                    postCount: genderData.statsData.male.postCount.toLocaleString(),
                    engagement: genderData.statsData.male.engagement.toFixed(1),
                    netSentiment: (genderData.statsData.male.netSentiment * 100).toFixed(1) + '%',
                    potentialReach: genderData.statsData.male.potentialReach.toLocaleString()
                },
                {
                    gender: 'Female',
                    authorCount: genderData.statsData.female.authorCount.toLocaleString(),
                    postCount: genderData.statsData.female.postCount.toLocaleString(),
                    engagement: genderData.statsData.female.engagement.toFixed(1),
                    netSentiment: (genderData.statsData.female.netSentiment * 100).toFixed(1) + '%',
                    potentialReach: genderData.statsData.female.potentialReach.toLocaleString()
                }
            ];

            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.gender}</td>
                    <td>${row.authorCount}</td>
                    <td>${row.postCount}</td>
                    <td>${row.engagement}</td>
                    <td>${row.netSentiment}</td>
                    <td>${row.potentialReach}</td>
                `;
                tableBody.appendChild(tr);
            });
        }

        function downloadChart(chartId, filename) {
            let chart;
            if (chartId === 'timeChart') chart = timeChart;
            else if (chartId === 'topChart') chart = topChart;
            else if (chartId === 'countryChart') chart = countryChart;
            else if (chartId === 'platformChart') chart = platformChart;
            else if (chartId === 'sentimentChart') chart = sentimentChart;
            else if (chartId === 'languageChart') chart = languageChart;
            
            if (chart) {
                const url = chart.getDataURL({
                    pixelRatio: 2,
                    backgroundColor: '#fff'
                });
                const link = document.createElement('a');
                link.href = url;
                link.download = filename + '.png';
                link.click();
            }
        }

        function downloadTableData() {
            const table = document.getElementById('dataTable');
            const rows = [];
            
            // Get headers
            const headers = [];
            table.querySelectorAll('thead th').forEach(th => {
                headers.push(th.textContent.trim());
            });
            rows.push(headers.join(','));
            
            // Get data rows
            table.querySelectorAll('tbody tr').forEach(tr => {
                const row = [];
                tr.querySelectorAll('td').forEach(td => {
                    row.push(td.textContent.trim());
                });
                rows.push(row.join(','));
            });
            
            const csvContent = rows.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'gender_analysis_table.csv';
            link.click();
            URL.revokeObjectURL(url);
        }

        function downloadData() {
            const dataStr = JSON.stringify(genderData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'gender_analysis_data.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        // Handle window resize
        window.addEventListener('resize', function() {
            if (timeChart) timeChart.resize();
            if (countryChart) countryChart.resize();
            if (platformChart) platformChart.resize();
            if (sentimentChart) sentimentChart.resize();
            if (languageChart) languageChart.resize();
            if (topChart) topChart.resize();
        });
    </script>
</body>
</html>