<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f8f9fa;
            color: #333;
            max-width: 1900px;
            margin: 0 auto;
            padding: 20px;
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .card-header {
            background-color: #f1f5f9;
            border-bottom: none;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f1f5f9;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .map-container {
            position: relative;
            height: 600px;
            width: 100%;
            background-color: #fff;
        }
        .country {
            fill: #e0e0e0;
            stroke: #fff;
            stroke-width: 0.5px;
        }
        .bubble {
            stroke: #fff;
            stroke-width: 1px;
            opacity: 0.8;
        }
        .tooltip {
            position: absolute;
            padding: 10px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ddd;
            border-radius: 5px;
            pointer-events: none;
            font-size: 14px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        .legend-color {
            width: 15px;
            height: 15px;
            margin-right: 5px;
            border-radius: 50%;
        }
        .legend-size {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        .legend-bubble {
            border-radius: 50%;
            background: rgba(70, 130, 180, 0.6);
            border: 1px solid #fff;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">Top Creator Countries - Geographic Distribution</div>
                    <div class="card-body">
                        <div class="map-container" id="map"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">Global Top 15 Creator Countries Data Overview</div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Country</th>
                                        <th>Number of Creators</th>
                                        <th>Global Share (%)</th>
                                        <th>Total Followers (Billions)</th>
                                        <th>Dominant Category</th>
                                    </tr>
                                </thead>
                                <tbody id="countriesTableBody">
                                    <!-- Table data will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample data for top creator countries
        const countryData = [
            { 
                rank: 1,
                country: "United States", 
                creators: 1250000,
                globalShare: 28.5,
                totalFollowers: 4.8,
                dominantCategory: "Entertainment",
                coordinates: [-95.7129, 37.0902]
            },
            { 
                rank: 2,
                country: "China", 
                creators: 980000,
                globalShare: 22.3,
                totalFollowers: 3.9,
                dominantCategory: "Lifestyle",
                coordinates: [104.1954, 35.8617]
            },
            { 
                rank: 3,
                country: "India", 
                creators: 750000,
                globalShare: 17.1,
                totalFollowers: 3.2,
                dominantCategory: "Music",
                coordinates: [78.9629, 20.5937]
            },
            { 
                rank: 4,
                country: "Brazil", 
                creators: 320000,
                globalShare: 7.3,
                totalFollowers: 1.8,
                dominantCategory: "Sports",
                coordinates: [-51.9253, -14.2350]
            },
            { 
                rank: 5,
                country: "United Kingdom", 
                creators: 280000,
                globalShare: 6.4,
                totalFollowers: 1.5,
                dominantCategory: "Comedy",
                coordinates: [-3.4360, 55.3781]
            },
            { 
                rank: 6,
                country: "Japan", 
                creators: 210000,
                globalShare: 4.8,
                totalFollowers: 1.2,
                dominantCategory: "Gaming",
                coordinates: [138.2529, 36.2048]
            },
            { 
                rank: 7,
                country: "South Korea", 
                creators: 185000,
                globalShare: 4.2,
                totalFollowers: 1.1,
                dominantCategory: "Beauty",
                coordinates: [127.7669, 35.9078]
            },
            { 
                rank: 8,
                country: "Indonesia", 
                creators: 165000,
                globalShare: 3.8,
                totalFollowers: 0.95,
                dominantCategory: "Lifestyle",
                coordinates: [113.9213, -0.7893]
            },
            { 
                rank: 9,
                country: "Germany", 
                creators: 145000,
                globalShare: 3.3,
                totalFollowers: 0.85,
                dominantCategory: "Education",
                coordinates: [10.4515, 51.1657]
            },
            { 
                rank: 10,
                country: "France", 
                creators: 130000,
                globalShare: 3.0,
                totalFollowers: 0.78,
                dominantCategory: "Fashion",
                coordinates: [2.2137, 46.2276]
            },
            { 
                rank: 11,
                country: "Canada", 
                creators: 120000,
                globalShare: 2.7,
                totalFollowers: 0.72,
                dominantCategory: "Education",
                coordinates: [-106.3468, 56.1304]
            },
            { 
                rank: 12,
                country: "Russia", 
                creators: 115000,
                globalShare: 2.6,
                totalFollowers: 0.68,
                dominantCategory: "Entertainment",
                coordinates: [105.3188, 61.5240]
            },
            { 
                rank: 13,
                country: "Mexico", 
                creators: 105000,
                globalShare: 2.4,
                totalFollowers: 0.63,
                dominantCategory: "Food",
                coordinates: [-102.5528, 23.6345]
            },
            { 
                rank: 14,
                country: "Australia", 
                creators: 95000,
                globalShare: 2.2,
                totalFollowers: 0.57,
                dominantCategory: "Travel",
                coordinates: [133.7751, -25.2744]
            },
            { 
                rank: 15,
                country: "Spain", 
                creators: 85000,
                globalShare: 1.9,
                totalFollowers: 0.51,
                dominantCategory: "Sports",
                coordinates: [-3.7492, 40.4637]
            }
        ];

        // Category color mapping
        const categoryColors = {
            "Entertainment": "#FF6384",
            "Lifestyle": "#36A2EB",
            "Music": "#FFCE56",
            "Sports": "#4BC0C0",
            "Comedy": "#9966FF",
            "Gaming": "#FF9F40",
            "Beauty": "#F763FF",
            "Education": "#6384FF",
            "Fashion": "#63FFAC",
            "Food": "#FF6363",
            "Travel": "#63D1FF"
        };

        // Populate the table
        function populateTable() {
            const tableBody = document.getElementById('countriesTableBody');
            countryData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.rank}</td>
                    <td>${item.country}</td>
                    <td>${item.creators.toLocaleString()}</td>
                    <td>${item.globalShare.toFixed(1)}%</td>
                    <td>${item.totalFollowers.toFixed(2)}</td>
                    <td>
                        <span style="display: inline-block; width: 12px; height: 12px; background-color: ${categoryColors[item.dominantCategory]}; border-radius: 50%; margin-right: 5px;"></span>
                        ${item.dominantCategory}
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Create geographic bubble map
        function createBubbleMap() {
            const width = document.getElementById('map').clientWidth;
            const height = document.getElementById('map').clientHeight;
            
            // Create SVG
            const svg = d3.select("#map")
                .append("svg")
                .attr("width", width)
                .attr("height", height);
            
            // Create a projection
            const projection = d3.geoNaturalEarth1()
                .scale(width / 5.5)
                .translate([width / 2, height / 2]);
            
            // Create a path generator
            const path = d3.geoPath()
                .projection(projection);
            
            // Create a tooltip
            const tooltip = d3.select("#map")
                .append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);
            
            // Load world map data
            d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json").then(function(world) {
                // Draw countries
                svg.append("g")
                    .selectAll("path")
                    .data(topojson.feature(world, world.objects.countries).features)
                    .enter().append("path")
                    .attr("class", "country")
                    .attr("d", path);
                
                // Scale for bubble size
                const bubbleScale = d3.scaleSqrt()
                    .domain([0, d3.max(countryData, d => d.totalFollowers)])
                    .range([5, 50]);
                
                // Add bubbles
                svg.selectAll("circle")
                    .data(countryData)
                    .enter()
                    .append("circle")
                    .attr("class", "bubble")
                    .attr("cx", d => projection(d.coordinates)[0])
                    .attr("cy", d => projection(d.coordinates)[1])
                    .attr("r", d => bubbleScale(d.totalFollowers))
                    .attr("fill", d => categoryColors[d.dominantCategory])
                    .on("mouseover", function(event, d) {
                        tooltip.transition()
                            .duration(200)
                            .style("opacity", .9);
                        tooltip.html(`
                            <strong>${d.country}</strong><br/>
                            Rank: ${d.rank}<br/>
                            Creators: ${d.creators.toLocaleString()}<br/>
                            Global Share: ${d.globalShare.toFixed(1)}%<br/>
                            Total Followers: ${d.totalFollowers.toFixed(2)} billion<br/>
                            Dominant Category: ${d.dominantCategory}
                        `)
                            .style("left", (event.pageX + 10) + "px")
                            .style("top", (event.pageY - 28) + "px");
                    })
                    .on("mouseout", function() {
                        tooltip.transition()
                            .duration(500)
                            .style("opacity", 0);
                    });
                
                // Add category legend
                const legend = svg.append("g")
                    .attr("class", "legend")
                    .attr("transform", `translate(${width - 180}, ${height - 200})`);
                
                legend.append("rect")
                    .attr("width", 160)
                    .attr("height", 180)
                    .attr("fill", "white")
                    .attr("opacity", 0.8)
                    .attr("rx", 5);
                
                const categories = [...new Set(countryData.map(d => d.dominantCategory))];
                
                categories.forEach((category, i) => {
                    const legendItem = legend.append("g")
                        .attr("transform", `translate(10, ${i * 20 + 20})`);
                    
                    legendItem.append("circle")
                        .attr("r", 6)
                        .attr("fill", categoryColors[category]);
                    
                    legendItem.append("text")
                        .attr("x", 15)
                        .attr("y", 5)
                        .text(category)
                        .style("font-size", "12px");
                });
                
                // Add size legend
                const sizeLegend = svg.append("g")
                    .attr("transform", `translate(20, ${height - 80})`);
                
                const sizes = [0.5, 2, 4];
                
                sizeLegend.append("rect")
                    .attr("width", 220)
                    .attr("height", 60)
                    .attr("fill", "white")
                    .attr("opacity", 0.8)
                    .attr("rx", 5);
                
                sizeLegend.append("text")
                    .attr("x", 10)
                    .attr("y", 20)
                    .text("Total Followers (Billions)")
                    .style("font-size", "12px")
                    .style("font-weight", "bold");
                
                sizes.forEach((size, i) => {
                    sizeLegend.append("circle")
                        .attr("cx", 30 + i * 60)
                        .attr("cy", 40)
                        .attr("r", bubbleScale(size))
                        .attr("fill", "steelblue")
                        .attr("opacity", 0.6)
                        .attr("stroke", "#fff");
                    
                    sizeLegend.append("text")
                        .attr("x", 30 + i * 60)
                        .attr("y", 40 + bubbleScale(size) + 15)
                        .attr("text-anchor", "middle")
                        .text(size.toFixed(1))
                        .style("font-size", "10px");
                });
            });
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            populateTable();
            createBubbleMap();
        });
    </script>
</body>
</html>
