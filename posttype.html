<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Type Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- 表格排序样式 -->
    <style>
        .data-table th {
            cursor: pointer;
            position: relative;
            padding-right: 20px;
        }
        .data-table th::after {
            content: "";
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
        }
        .data-table th.sort-asc::after {
            content: "▲";
            font-size: 10px;
        }
        .data-table th.sort-desc::after {
            content: "▼";
            font-size: 10px;
        }
    </style>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }
        .dashboard {
            max-width: 1900px;
            margin: 0 auto;
        }
        /* 移除页面总标题 */
        .chart-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 30px;
        }
        .chart-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .chart-box {
            flex: 1;
            min-width: 350px;
        }
        .main-chart {
            min-height: 550px;
        }
        h1 {
            color: white;
            margin-bottom: 10px;
        }
        h2 {
            color: #2c3e50;
            font-size: 1.3em;
            margin-top: 0;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .data-table th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .data-table tr:hover {
            background-color: #f1f1f1;
        }
        .table-container {
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }
        .download-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .download-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- 页面总标题已移除 -->

        <div class="chart-row">
            <div class="chart-container main-chart" style="flex: 1.2;">
                <h2>Post Type Distribution (Donut Chart)</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <div></div>
                    <button class="download-btn" onclick="downloadChart('donutChart', 'post_type_distribution')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>
                <div class="chart-box">
                    <canvas id="donutChart"></canvas>
                </div>
            </div>
            <div class="chart-container" style="flex: 1.8;">
                <h2>Monthly Video Contribution (Stacked Bar Chart)</h2>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <div>
                        <select id="timeUnitSelector" class="time-selector" style="padding: 6px; border-radius: 4px; border: 1px solid #ddd;">
                            <option value="day">(Day)</option>
                            <option value="week">(Week)</option>
                            <option value="month" selected>(Month)</option>
                            <option value="year">(Year)</option>
                        </select>
                    </div>
                    <button class="download-btn" onclick="downloadChart('stackedBarChart', 'monthly_video_contribution')">
                        <i class="fas fa-download"></i> Download
                    </button>
                </div>
                <div class="chart-box">
                    <canvas id="stackedBarChart"></canvas>
                </div>
            </div>
        </div>

        <div class="chart-container">
            <h2>Post Performance Analysis (Bubble Chart)</h2>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <div></div>
                <button class="download-btn" onclick="downloadChart('bubbleChart', 'post_performance_analysis')">
                    <i class="fas fa-download"></i> Download
                </button>
            </div>
            <div class="chart-box">
                <canvas id="bubbleChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2>Detailed Metrics by Post Type</h2>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <div></div>
                <button class="download-btn" onclick="downloadTable('data-table', 'detailed_metrics_by_post_type')">
                    <i class="fas fa-download"></i> Download
                </button>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Post Type</th>
                            <th>Number of Posts</th>
                            <th>Percentage of Posts</th>
                            <th>Total Views</th>
                            <th>Average Views/Post</th>
                            <th>Total Interactions</th>
                            <th>Average Interaction Rate</th>
                            <th>Total Creators</th>
                            <th>Percentage of Top Posts (Views > 1M)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Tech Reviewers</td>
                            <td>1,250</td>
                            <td>12.5%</td>
                            <td>85,000,000</td>
                            <td>68,000</td>
                            <td>3,400,000</td>
                            <td>4.0%</td>
                            <td>120</td>
                            <td>2.8%</td>
                        </tr>
                        <tr>
                            <td>Beauty Gurus</td>
                            <td>1,800</td>
                            <td>18.0%</td>
                            <td>120,000,000</td>
                            <td>66,667</td>
                            <td>6,000,000</td>
                            <td>5.0%</td>
                            <td>150</td>
                            <td>3.2%</td>
                        </tr>
                        <tr>
                            <td>Gaming Streamers</td>
                            <td>2,700</td>
                            <td>27.0%</td>
                            <td>216,000,000</td>
                            <td>80,000</td>
                            <td>10,800,000</td>
                            <td>5.0%</td>
                            <td>180</td>
                            <td>4.5%</td>
                        </tr>
                        <tr>
                            <td>Fitness Coaches</td>
                            <td>750</td>
                            <td>7.5%</td>
                            <td>37,500,000</td>
                            <td>50,000</td>
                            <td>1,500,000</td>
                            <td>4.0%</td>
                            <td>90</td>
                            <td>1.8%</td>
                        </tr>
                        <tr>
                            <td>Travel Vloggers</td>
                            <td>900</td>
                            <td>9.0%</td>
                            <td>63,000,000</td>
                            <td>70,000</td>
                            <td>2,520,000</td>
                            <td>4.0%</td>
                            <td>100</td>
                            <td>2.5%</td>
                        </tr>
                        <tr>
                            <td>Food Bloggers</td>
                            <td>1,400</td>
                            <td>14.0%</td>
                            <td>98,000,000</td>
                            <td>70,000</td>
                            <td>4,900,000</td>
                            <td>5.0%</td>
                            <td>140</td>
                            <td>3.0%</td>
                        </tr>
                        <tr>
                            <td>DIY Crafters</td>
                            <td>500</td>
                            <td>5.0%</td>
                            <td>25,000,000</td>
                            <td>50,000</td>
                            <td>1,000,000</td>
                            <td>4.0%</td>
                            <td>80</td>
                            <td>1.2%</td>
                        </tr>
                        <tr>
                            <td>Finance Experts</td>
                            <td>400</td>
                            <td>4.0%</td>
                            <td>32,000,000</td>
                            <td>80,000</td>
                            <td>1,280,000</td>
                            <td>4.0%</td>
                            <td>50</td>
                            <td>2.0%</td>
                        </tr>
                        <tr>
                            <td>Comedy Sketchers</td>
                            <td>1,100</td>
                            <td>11.0%</td>
                            <td>77,000,000</td>
                            <td>70,000</td>
                            <td>3,850,000</td>
                            <td>5.0%</td>
                            <td>110</td>
                            <td>2.8%</td>
                        </tr>
                        <tr>
                            <td>Educational Channels</td>
                            <td>700</td>
                            <td>7.0%</td>
                            <td>49,000,000</td>
                            <td>70,000</td>
                            <td>1,470,000</td>
                            <td>3.0%</td>
                            <td>70</td>
                            <td>1.5%</td>
                        </tr>
                        <tr>
                            <td>ASMR Artists</td>
                            <td>300</td>
                            <td>3.0%</td>
                            <td>21,000,000</td>
                            <td>70,000</td>
                            <td>840,000</td>
                            <td>4.0%</td>
                            <td>60</td>
                            <td>1.0%</td>
                        </tr>
                        <tr>
                            <td>Parenting Vloggers</td>
                            <td>350</td>
                            <td>3.5%</td>
                            <td>17,500,000</td>
                            <td>50,000</td>
                            <td>700,000</td>
                            <td>4.0%</td>
                            <td>70</td>
                            <td>0.8%</td>
                        </tr>
                        <tr>
                            <td>Book Reviewers</td>
                            <td>250</td>
                            <td>2.5%</td>
                            <td>12,500,000</td>
                            <td>50,000</td>
                            <td>500,000</td>
                            <td>4.0%</td>
                            <td>50</td>
                            <td>0.5%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // 下载图表功能
        function downloadChart(chartId, filename) {
            const canvas = document.getElementById(chartId);
            const link = document.createElement('a');
            link.download = filename + '.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        // 下载表格功能
        function downloadTable(tableClass, filename) {
            const table = document.querySelector('.' + tableClass);
            let csv = [];
            const rows = table.querySelectorAll('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const row = [], cols = rows[i].querySelectorAll('td, th');
                
                for (let j = 0; j < cols.length; j++) {
                    let data = cols[j].innerText.replace(/(\r\n|\n|\r)/gm, '').replace(/,/g, ';');
                    row.push('"' + data + '"');
                }
                
                csv.push(row.join(','));
            }
            
            const csvString = csv.join('\n');
            const link = document.createElement('a');
            link.download = filename + '.csv';
            const blob = new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            link.href = URL.createObjectURL(blob);
            link.click();
        }
        
        // 表格排序功能
        document.addEventListener('DOMContentLoaded', function() {
            const table = document.querySelector('.data-table');
            const headers = table.querySelectorAll('th');
            const tableBody = table.querySelector('tbody');
            const rows = tableBody.querySelectorAll('tr');
            
            // 为每个表头添加点击事件
            headers.forEach(function(header, index) {
                header.addEventListener('click', function() {
                    // 移除所有表头的排序类
                    headers.forEach(h => {
                        h.classList.remove('sort-asc', 'sort-desc');
                    });
                    
                    // 确定排序方向
                    const isAscending = !this.classList.contains('sort-asc');
                    
                    // 添加适当的排序类
                    this.classList.add(isAscending ? 'sort-asc' : 'sort-desc');
                    
                    // 获取所有行并转换为数组
                    const rowsArray = Array.from(rows);
                    
                    // 根据当前列排序行
                    rowsArray.sort(function(rowA, rowB) {
                        const cellA = rowA.querySelectorAll('td')[index].textContent.trim();
                        const cellB = rowB.querySelectorAll('td')[index].textContent.trim();
                        
                        // 检查是否为数字（包括带逗号的数字和百分比）
                        const numA = parseFloat(cellA.replace(/,/g, '').replace(/%/g, ''));
                        const numB = parseFloat(cellB.replace(/,/g, '').replace(/%/g, ''));
                        
                        if (!isNaN(numA) && !isNaN(numB)) {
                            return isAscending ? numA - numB : numB - numA;
                        } else {
                            return isAscending ? 
                                cellA.localeCompare(cellB) : 
                                cellB.localeCompare(cellA);
                        }
                    });
                    
                    // 将排序后的行重新添加到表格中
                    rowsArray.forEach(function(row) {
                        tableBody.appendChild(row);
                    });
                });
            });
        });

        // Donut Chart - Post Type Distribution
        const donutCtx = document.getElementById('donutChart').getContext('2d');
        const donutChart = new Chart(donutCtx, {
            type: 'doughnut',
            data: {
                labels: [
                    'Tech Reviewers', 
                    'Beauty Gurus', 
                    'Gaming Streamers', 
                    'Fitness Coaches',
                    'Travel Vloggers',
                    'Food Bloggers',
                    'DIY Crafters',
                    'Finance Experts',
                    'Comedy Sketchers',
                    'Educational Channels',
                    'ASMR Artists',
                    'Parenting Vloggers',
                    'Book Reviewers'
                ],
                datasets: [{
                    data: [12.5, 18, 27, 7.5, 9, 14, 5, 4, 11, 7, 3, 3.5, 2.5],
                    backgroundColor: [
                        '#4e79a7', '#f28e2c', '#e15759', '#76b7b2', '#59a14f',
                        '#edc949', '#af7aa1', '#ff9da7', '#9c755f', '#bab0ab',
                        '#6b9ac4', '#d37295', '#a6cee3'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                cutout: '70%',
                plugins: {
                    legend: {
                        position: 'right',
                    },
                    title: {
                        display: true,
                        text: 'Creator Type Distribution (%)',
                        font: {
                            size: 16
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.raw}%`;
                            }
                        }
                    },
                    datalabels: {
                        formatter: (value) => {
                            return `${value}%`;
                        },
                        color: '#fff',
                        font: {
                            weight: 'bold'
                        }
                    }
                }
            },
            plugins: [ChartDataLabels]
        });

        // 不同时间维度的数据
        const timeUnitData = {
            day: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [
                    {
                        label: 'Tech Reviewers',
                        data: [15, 18, 20, 17, 22, 14, 12],
                        backgroundColor: '#4e79a7',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Beauty Gurus',
                        data: [25, 28, 30, 27, 32, 24, 22],
                        backgroundColor: '#f28e2c',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Gaming Streamers',
                        data: [35, 38, 40, 37, 42, 34, 32],
                        backgroundColor: '#e15759',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Fitness Coaches',
                        data: [10, 12, 14, 11, 15, 9, 8],
                        backgroundColor: '#76b7b2',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Travel Vloggers',
                        data: [12, 14, 16, 13, 17, 11, 10],
                        backgroundColor: '#59a14f',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Food Bloggers',
                        data: [20, 22, 24, 21, 25, 19, 18],
                        backgroundColor: '#edc949',
                        stack: 'Stack 0'
                    }
                ],
                title: 'Daily Video Contribution by Creator Type',
                xTitle: 'Day'
            },
            week: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                datasets: [
                    {
                        label: 'Tech Reviewers',
                        data: [45, 50, 55, 60],
                        backgroundColor: '#4e79a7',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Beauty Gurus',
                        data: [65, 70, 75, 80],
                        backgroundColor: '#f28e2c',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Gaming Streamers',
                        data: [95, 100, 105, 110],
                        backgroundColor: '#e15759',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Fitness Coaches',
                        data: [25, 30, 35, 40],
                        backgroundColor: '#76b7b2',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Travel Vloggers',
                        data: [30, 35, 40, 45],
                        backgroundColor: '#59a14f',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Food Bloggers',
                        data: [50, 55, 60, 65],
                        backgroundColor: '#edc949',
                        stack: 'Stack 0'
                    }
                ],
                title: 'Weekly Video Contribution by Creator Type',
                xTitle: 'Week'
            },
            month: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                datasets: [
                    {
                        label: 'Tech Reviewers',
                        data: [120, 130, 125, 140, 150, 160, 170],
                        backgroundColor: '#4e79a7',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Beauty Gurus',
                        data: [180, 190, 185, 200, 210, 220, 230],
                        backgroundColor: '#f28e2c',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Gaming Streamers',
                        data: [270, 280, 290, 300, 310, 320, 330],
                        backgroundColor: '#e15759',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Fitness Coaches',
                        data: [75, 80, 85, 90, 95, 100, 105],
                        backgroundColor: '#76b7b2',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Travel Vloggers',
                        data: [90, 95, 100, 105, 110, 115, 120],
                        backgroundColor: '#59a14f',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Food Bloggers',
                        data: [140, 145, 150, 155, 160, 165, 170],
                        backgroundColor: '#edc949',
                        stack: 'Stack 0'
                    }
                ],
                title: 'Monthly Video Contribution by Creator Type',
                xTitle: 'Month'
            },
            year: {
                labels: ['2020', '2021', '2022', '2023'],
                datasets: [
                    {
                        label: 'Tech Reviewers',
                        data: [1200, 1300, 1400, 1500],
                        backgroundColor: '#4e79a7',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Beauty Gurus',
                        data: [1800, 1900, 2000, 2100],
                        backgroundColor: '#f28e2c',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Gaming Streamers',
                        data: [2700, 2800, 2900, 3000],
                        backgroundColor: '#e15759',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Fitness Coaches',
                        data: [750, 800, 850, 900],
                        backgroundColor: '#76b7b2',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Travel Vloggers',
                        data: [900, 950, 1000, 1050],
                        backgroundColor: '#59a14f',
                        stack: 'Stack 0'
                    },
                    {
                        label: 'Food Bloggers',
                        data: [1400, 1450, 1500, 1550],
                        backgroundColor: '#edc949',
                        stack: 'Stack 0'
                    }
                ],
                title: 'Yearly Video Contribution by Creator Type',
                xTitle: 'Year'
            }
        };

        // Stacked Bar Chart - Video Contribution
        const stackedBarCtx = document.getElementById('stackedBarChart').getContext('2d');
        let currentTimeUnit = 'month'; // 默认显示月度数据
        const stackedBarChart = new Chart(stackedBarCtx, {
            type: 'bar',
            data: timeUnitData[currentTimeUnit],
            options: {
                responsive: true,
                scales: {
                    x: {
                        stacked: true,
                        title: {
                            display: true,
                            text: timeUnitData[currentTimeUnit].xTitle
                        }
                    },
                    y: {
                        stacked: true,
                        title: {
                            display: true,
                            text: 'Number of Videos'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: timeUnitData[currentTimeUnit].title,
                        font: {
                            size: 16
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    },
                    legend: {
                        position: 'bottom',
                    }
                }
            }
        });
        
        // 时间维度选择器事件处理
        document.getElementById('timeUnitSelector').addEventListener('change', function() {
            currentTimeUnit = this.value;
            stackedBarChart.data.labels = timeUnitData[currentTimeUnit].labels;
            stackedBarChart.data.datasets = timeUnitData[currentTimeUnit].datasets;
            stackedBarChart.options.plugins.title.text = timeUnitData[currentTimeUnit].title;
            stackedBarChart.options.scales.x.title.text = timeUnitData[currentTimeUnit].xTitle;
            stackedBarChart.update();
        });

        // Bubble Chart - Creator Performance
        const bubbleCtx = document.getElementById('bubbleChart').getContext('2d');
        const bubbleChart = new Chart(bubbleCtx, {
            type: 'bubble',
            data: {
                datasets: [
                    {
                        label: 'Tech Reviewers',
                        data: [{
                            x: 1250,
                            y: 68000,
                            r: 34
                        }],
                        backgroundColor: '#4e79a7'
                    },
                    {
                        label: 'Beauty Gurus',
                        data: [{
                            x: 1800,
                            y: 66667,
                            r: 60
                        }],
                        backgroundColor: '#f28e2c'
                    },
                    {
                        label: 'Gaming Streamers',
                        data: [{
                            x: 2700,
                            y: 80000,
                            r: 108
                        }],
                        backgroundColor: '#e15759'
                    },
                    {
                        label: 'Fitness Coaches',
                        data: [{
                            x: 750,
                            y: 50000,
                            r: 15
                        }],
                        backgroundColor: '#76b7b2'
                    },
                    {
                        label: 'Travel Vloggers',
                        data: [{
                            x: 900,
                            y: 70000,
                            r: 25
                        }],
                        backgroundColor: '#59a14f'
                    },
                    {
                        label: 'Food Bloggers',
                        data: [{
                            x: 1400,
                            y: 70000,
                            r: 49
                        }],
                        backgroundColor: '#edc949'
                    },
                    {
                        label: 'DIY Crafters',
                        data: [{
                            x: 500,
                            y: 50000,
                            r: 10
                        }],
                        backgroundColor: '#af7aa1'
                    },
                    {
                        label: 'Finance Experts',
                        data: [{
                            x: 400,
                            y: 80000,
                            r: 13
                        }],
                        backgroundColor: '#ff9da7'
                    },
                    {
                        label: 'Comedy Sketchers',
                        data: [{
                            x: 1100,
                            y: 70000,
                            r: 39
                        }],
                        backgroundColor: '#9c755f'
                    },
                    {
                        label: 'Educational Channels',
                        data: [{
                            x: 700,
                            y: 70000,
                            r: 15
                        }],
                        backgroundColor: '#bab0ab'
                    },
                    {
                        label: 'ASMR Artists',
                        data: [{
                            x: 300,
                            y: 70000,
                            r: 8
                        }],
                        backgroundColor: '#6b9ac4'
                    },
                    {
                        label: 'Parenting Vloggers',
                        data: [{
                            x: 350,
                            y: 50000,
                            r: 7
                        }],
                        backgroundColor: '#d37295'
                    },
                    {
                        label: 'Book Reviewers',
                        data: [{
                            x: 250,
                            y: 50000,
                            r: 5
                        }],
                        backgroundColor: '#a6cee3'
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Number of Videos'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Average Views per Video'
                        }
                    }
                },
                plugins: {
                    title: {
                        display: true,
                        text: 'Creator Performance Analysis (Bubble size = Total Engagement in 100k)',
                        font: {
                            size: 16
                        }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const label = context.dataset.label || '';
                                const data = context.raw;
                                return `${label}: ${data.x} videos, ${data.y.toLocaleString()} avg views, ${(data.r*100000).toLocaleString()} total engagement`;
                            }
                        }
                    },
                    legend: {
                        position: 'bottom',
                    }
                }
            }
        });
    </script>

    <!-- 使用纯JavaScript实现表格排序 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table = document.querySelector('.data-table');
            const headers = table.querySelectorAll('th');
            const tableBody = table.querySelector('tbody');
            const rows = tableBody.querySelectorAll('tr');
            
            // 为每个表头添加点击事件
            headers.forEach(function(header, index) {
                header.addEventListener('click', function() {
                    // 清除所有表头的排序标记
                    headers.forEach(h => {
                        h.classList.remove('sort-asc', 'sort-desc');
                    });
                    
                    // 确定排序方向
                    const isAscending = !header.classList.contains('sort-asc');
                    header.classList.add(isAscending ? 'sort-asc' : 'sort-desc');
                    
                    // 获取所有行并转换为数组
                    const rowsArray = Array.from(rows);
                    
                    // 排序行
                    const sortedRows = rowsArray.sort(function(a, b) {
                        const aColText = a.querySelector(`td:nth-child(${index + 1})`).textContent.trim();
                        const bColText = b.querySelector(`td:nth-child(${index + 1})`).textContent.trim();
                        
                        // 处理数字格式（包括逗号和百分号）
                        const aValue = parseValue(aColText);
                        const bValue = parseValue(bColText);
                        
                        return isAscending ? compareValues(aValue, bValue) : compareValues(bValue, aValue);
                    });
                    
                    // 从表格中移除所有现有行
                    while (tableBody.firstChild) {
                        tableBody.removeChild(tableBody.firstChild);
                    }
                    
                    // 添加排序后的行
                    tableBody.append(...sortedRows);
                });
            });
            
            // 解析各种格式的值（文本、数字、百分比等）
            function parseValue(value) {
                // 移除千位分隔符
                value = value.replace(/,/g, '');
                
                // 检查是否为百分比
                if (value.endsWith('%')) {
                    return parseFloat(value) / 100;
                }
                
                // 尝试转换为数字
                const parsedValue = parseFloat(value);
                return isNaN(parsedValue) ? value.toLowerCase() : parsedValue;
            }
            
            // 比较两个值
            function compareValues(a, b) {
                if (typeof a === 'string' && typeof b === 'string') {
                    return a.localeCompare(b);
                }
                return a - b;
            }
        });
    </script>
</body>
</html>
